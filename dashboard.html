<html>

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Account Level Dashboard for Imperva Incapsula APIs">
    <meta name="author" content="Jonathan Gruber Imperva">
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="favico.png">

    <title>Account Imperva Incapsula Dashboard</title>
    <!-- CSS LIBRARIES -->
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css"
        integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <!-- Custom CSS -->
    <link href="css/lib/calendar2/semantic.ui.min.css" rel="stylesheet" type="text/css">
    <link href="css/lib/bootstrap/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="css/lib/sweetalert/sweetalert.css" rel="stylesheet" type="text/css">
    <link href="css/lib/toastr/toastr.min.css" rel="stylesheet" type="text/css">
</head>



    <style>
       /* Styles  */
    threatmap {
        width: 100%;
        height: 500px;
    }
        td {
            padding: 7px;
        }

        th {
            padding: 14px;
        }
    </style>

<body class="fix-header fix-sidebar">

    <!-- page wrapper -->
    <div class="main-wrapper">

        <!-- HEADER BAR  -->
        <div class="header">
            <div class="col-md-6"></div>
            <nav class="navbar top-navbar navbar-expand-md navbar-light">
                <!-- Logo -->
                <div class="navbar-header> 
                    <a class=" navbar-brand" href="dashboard.html">
                    <!-- Dashboard logo icon  -->
                    <b style="font-size:30;color:#37347F"><img src="incapse.png" alt="homepage" class="dark-logo"
                            style=" height:auto;margin-right: 2.5em" /> </b>
                    </a>
                </div>
                <div class="navbar-collapse">
                    <!-- toggle and nav items -->
                    <ul class="navbar-nav mr-auto mt-md-0">
                        <!-- 3 LINES WHEN BROWSER COMPRESSED  -->
                        <li class="nav-item m-l-4"> <a class="nav-link sidebartoggler text-muted"
                                href="javascript:void(0)"><i class="fa fa-th-large"></i></a> </li>
                        <li>
                            <h3 class="text-primary"> Account Level Dashboard</h3>
                        </li>
                    </ul>
                </div>
                <div class="col-md-3"></div>
                <button class="btn btn-info" onclick="printPage()" style="font-size: 24px;">Generate PDF </button>
        </div>

    </div>
    <!-- End Logo -->
    </nav>
    </div>

    <!-- Left Sidebar  -->
    <div id="sidebar" class="left-sidebar">
    </div>
    <!-- End Left Sidebar  -->

    <!-- Container fluid for central page  -->
    <div id="export-pdf" class="page-wrapper">

        <div class="container-fluid">

            <!-- Print only dashboard title -->

            <div class="print-only">
                <div class="row">
                    <div class="col-12">
                        <div class="card" style="background-color: white">
                            <div class="card-body" style="background-color: white">
                                <h1>ACCOUNT LEVEL DASHBOARD </h1>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ROW for column of Account information -->
            <div class="row">

                <!-- account information -->
                <div class="col-md-4">
                    <div class="card card-outline-info">
                        <h2 class="m-b-0"><span id="account_name" class="m-b-0" style="font-weight: bold;">Account
                                Name</span>
                            <span id="account_id" class="m-b-0" style="float:right">00001</span>
                            <br>
                            <br>
                            <table>

                                <tbody>
                                    <tr>
                                        <td>Since: <span id="trial_end" ">tbd</span></td>
                              <td><span id="nb_users" style="font-weight: bold;">
                                                configured Users </span></td>

                                    </tr>

                                    <tr>
                                        <td>WAF Base Plan: </td>
                                        <td>
                                            <span id="plan_name" style="font-weight: bold;">tbd</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Bandwidth Utilization:</td>
                                        <td> <span id="used_bandwidth" style="font-weight: bold;">0 Mbps</span>
                                            <span id="purchased_bandwidth" style="font-weight: bold;">0 Mbps</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Websites Configured:</td>
                                        <td>
                                            <span id="nb_websites" style="font-weight: bold;">tbd</span></p>
                                        </td>
                                    </tr>

                                </tbody>
                            </table>
                    </div>
                </div>

                <!-- FEATURE LIST -->
                <div class="col-md-4">
                    <div class="card card-outline-info">
                        <h2 class="m-b-0"><span class="m-b-0" style="font-weight: bold;">Activated licenses</span>
                            <table>
                                <tbody>

                                    <tr>
                                        <td style="min-width: 160px;">SIEM license: </td>
                                        <td>
                                            <label class="switch">
                                                <input id="add_on_siem" type="checkbox" disabled>
                                                <span class="slider"></span>
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="min-width: 160px;">Attack Analytics: </td>
                                        <td>
                                            <label class="switch">
                                                <input id="add_on_aa" type="checkbox" disabled>
                                                <span class="slider"></span>
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="min-width: 160px;">Load Balancing: </td>
                                        <td>
                                            <label class="switch">
                                                <input id="add_on_lb" type="checkbox" disabled>
                                                <span class="slider"></span>
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="min-width: 160px;">DDoS: </td>
                                        <td>
                                            <label class="switch">
                                                <input id="add_on_ddos" type="checkbox" disabled>
                                                <span class="slider"></span>
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="min-width: 160px;">Support Level: </td>
                                        <td>
                                            <label class="label label-primary"> <span id="support_level">support
                                                    level</span> </label>
                                            </label>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                    </div>
                </div>


                <div class="col-md-4">
                    <div class="card card-outline-info">
                        <h2 class="m-b-0"><span class="m-b-0" style="font-weight: bold;">Account Structure</span>
                            </br>
                            <h4 class="card-title" > <span id="accountName2">Account Name</span><span id="accountnbsites"> 1</span></h4>
                            <div class="card-content">
                                <div class="nestable">
                                    <div class="dd">
                                        <ol class="dd-list" id="account_structure">
                                        </ol>
                                    </div>
                                </div>
                            </div>

                    </div>
                </div>


            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">
                            <h2>Executive Summary Assessment</h2>
                        </div>
                        <p class="f-w-600" style="margin-top: 30px;">SITES FULLY CONFIGURED <span class="pull-right"
                                id="configured right">0%</span></p>
                        <div class="progress ">
                            <div role="progressbar" id="configured" style="width: 0%;"
                                class="progress-bar bg-success wow animated progress-animated"> <span
                                    class="sr-only">60% Complete</span>
                            </div>
                        </div>
                        <p class="m-t-30 f-w-600" id="block" style="margin-top: 30px;">SECURITY SETTINGS IN BLOCKED
                            MODE<span class="pull-right" id="block right">0%</span></p>
                        <div class="progress">
                            <div role="progressbar" id="block progress" style="width: 0%;"
                                class="progress-bar bg-danger wow animated progress-animated"> <span class="sr-only">60%
                                    Complete</span>
                            </div>
                        </div>

                        <p class="m-t-30 f-w-600" style="margin-top: 30px;">CONFIGURED VS PURCHASED SITES<span
                                class="pull-right" id="configured sites">0%</span></p>
                        <div class="progress">
                            <div role="progressbar" id="configured_sites" style="width: 0%;"
                                class="progress-bar bg-info wow animated progress-animated"> <span class="sr-only">60%
                                    Complete</span>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">
                            <h2>95-percentile Traffic Utilization of last 3 months</h2>
                        </div>
                        <canvas id="95perc" style="max-height: 300px; width:auto"></canvas>
                    </div>
                </div>

            </div>

            <!-- ROW for line Security Assessment -->
            <div class="pagebreak"> </div>
            <div class="row">
                <div class="col-12">
                    <div class="card" style="background-color: #e6f7ff">
                        <div class="card-body" style="background-color: #e6f7ff">
                            <h1>SECURITY ASSESSMENT SUMMARY </h1>
                        </div>
                    </div>
                </div>
            </div>
            <!-- END ROW for line Security Assessment -->


            <!-- ROW 4 boxes for the 4 cards -->
            <div class="row">
                <div class="col-md-3">
                    <div class="card p-30">
                        <div class="media">
                            <div class="media-left meida media-middle">
                                <span><i class="fa fa-globe f-s-40 color-success" style="font-size:28"></i></span>
                            </div>
                            <div class="media-body media-text-right">
                                <h2 id="nb_configured" class="text-success">tbd
                                </h2>
                                <p class="m-b-0">Sites Fully Configured</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-30">
                        <div class="media">
                            <div class="media-left meida media-middle">
                                <span><i class="fa fa-exclamation-triangle f-s-40 color-danger"
                                        style="font-size:28"></i></span>
                            </div>
                            <div class="media-body media-text-right">
                                <h2 id="nb_security" class="text-danger">tbd</h2>
                                <p class="m-b-0">settings in Block mode</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-30">
                        <div class="media">
                            <div class="media-left meida media-middle">
                                <span><i class="fa fa-bolt f-s-40 color-warning" style="font-size:28"></i></span>
                            </div>
                            <div class="media-body media-text-right">
                                <h2 id="nb_ddos" class="text-warning">tbd</h2>
                                <p class="m-b-0">DDoS thresholds <> Default</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-30">
                        <div class="media">
                            <div class="media-left meida media-middle">
                                <span><i class="fa fa-user f-s-40 color-info" style="font-size:28"></i></span>
                            </div>
                            <div class="media-body media-text-right">
                                <h2 id="nb_incaprules" class="text-info">#</h2>
                                <p class="m-b-0">Incaprules configured</p><span style="font-size: 10px">valid 30days
                                    range only</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- ROW for column of the progress -->
            <div class="row">


                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">
                            <h2># Explicit Security Events per OWASP threat <span style="font-size: 10pt">(on selected
                                    period)</span> </h2>
                        </div>
                        <canvas id="threatChart"></canvas>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">
                            <h2># Custom and DDoS Security Events <span style="font-size: 10pt">(on selected
                                    period)</span> </h2>
                        </div>
                        <canvas id="threatChart_custom"></canvas>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <div class="card">
                        <div class="card-title">
                            <h2>Human Visitors</h2>
                        </div>
                        <div class="media">
                            <div class="media-left media-middle">
                                <span><i class="fas fa-child color-success" style="font-size:78"></i></span>
                            </div>
                            <div class="media-body media-text-right">
                                <h2 id="human_visits" class="text-success">50%</h2>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card">
                        <div class="card-title">
                            <h2>Bots Visitors</h2>
                        </div>
                        <div class="media">
                            <div class="media-left media-middle">
                                <h2 id="bot_visits" class="text-danger">50%</h2>
                            </div>
                            <div class="media-body media-text-right">
                                <span><i class="fas fa-robot color-danger" style="font-size:78"></i></span>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">
                            <h2>Visits per Bot type on all sites</h2>
                        </div>
                        <canvas id="BotsGraph"></canvas>
                    </div>
                </div>
                <!--            <div class="col-md-4" ">
                <div class="card" style="max-height: 500px"> 
                    <div class="card-title">
                        <h4>List of domains: more details</h4> <a style="color:blue" href="raw_tables.html">here</a>
                        </div>
                         <table class="table nowrap table-hover table-bordered table-striped table-responsive" id="api_list_sites">           
                        <tr>
                        <th>Site ID</th>
                        <th>Site Name</th>
                        <th>Site Status</th>
                        </table>
                </div> 
            </div>-->
            </div>
            <!-- END ROW for column of the progress -->


            <!-- ROW for line Performance Assessment TITLE-->
            <div class="pagebreak"> </div>
            <div class="row">
                <div class="col-12">
                    <div class="card" style="background-color: #e6fff2">
                        <div class="card-body" style="background-color: #e6fff2">
                            <h1>PERFORMANCE ASSESSMENT SUMMARY </h1>
                        </div>
                    </div>
                </div>
            </div>
            <!-- END ROW for Performance Assessment -->


            <!-- ROW 4 boxes for the 4 cards -->
            <div class="row">
                <div class="col-md-3">
                    <div class="card p-30">
                        <div class="media">
                            <div class="media-left meida media-middle">
                                <span><i class="fa fa-globe f-s-40 color-success" style="font-size:28"></i></span>
                            </div>
                            <div class="media-body media-text-right">
                                <h2 id="trafficVolume" class="text-success">tbd</h2>
                                <p class="m-b-0">Total Traffic period (Gbytes)</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-30">
                        <div class="media">
                            <div class="media-left meida media-middle">
                                <span><i class="fa fa-bolt f-s-40 color-success" style="font-size:28"></i></span>
                            </div>
                            <div class="media-body media-text-right">
                                <h2 id="cachingRatio" class="text-success">tbd</h2>
                                <p class="m-b-0">Global Caching Ratio</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-30">
                        <div class="media">
                            <div class="media-left meida media-middle">
                                <span><i class="fa fa-cloud f-s-40 color-warning" style="font-size:28"></i></span>
                            </div>
                            <div class="media-body media-text-right">
                                <h2 id="cachingSettings" class="text-warning">tbd</h2>
                                <p class="m-b-0">Sites with Static+Dynamic</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="card p-30">
                        <div class="media">
                            <div class="media-left meida media-middle">
                                <span><i class="fa fa-signal f-s-40 color-info" style="font-size:28"></i></span>
                            </div>
                            <div class="media-body media-text-right">
                                <h2 id="cached_total" class="text-info">tbd</h2>
                                <p class="m-b-0">Cached Bw (Gbytes)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>



            <!--  ROW for Traffic Graphs -->
            <div class="row">

                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">
                            <h2># Site Configured Trend last 6 months</h2>
                            <p>
                        </div>
                        <canvas id="site_addition" style="max-height: 300px" ;> </canvas>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">
                            <h2>Accumulated Cached Bandwidth in Account</h2>
                        </div>
                        <canvas id="bwGraph" style="max-height: 300px; width:auto"></canvas>
                    </div>
                </div>
            </div>
            <!--  END ROW for Traffic Graphs -->

            <!-- ROW for serving Data Centers vs visitors -->
            <div class="pagebreak"> </div>

            <!-- Map of Visitors per country row -->
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-title">
                            <h2>Map of Visitors per Country for all Sites</h2>
                        </div>
                        <div id="threatmap"></div>
                    </div>
                </div>
            </div>


            <!--  ROW for Traffic Graphs -->
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">
                            <h2>Visitors per Country (on all sites)</h2>
                            <p>
                        </div>
                        <canvas id="visitorsCountry"></canvas>
                    </div>
                </div>


                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">
                            <h2>Serving POPs (on all sites)</h2>
                            <p>
                                <span style="font-size: 12px">tip: compare with visited countries to see that customer
                                    is served by best POP</span>
                        </div>
                        <canvas id="POPCountry"></canvas>
                    </div>
                </div>
            </div>
            <!-- END ROW for serving data centers vs visitors -->



            <button class="btn btn-info" onclick="printPage()" style="font-size: 24px;">Generate PDF </button>


            <!-- footer -->
            <footer class="footer"> © 2018 Imperva dashboard for Incapsula APIs, not an Imperva product <a
                    href="https://github.com/imperva">Github Imperva Page</a></footer>
            <!-- End footer -->

        </div>
    </div> <!-- end page wrapper-->

</body>

</html>

<!-- START OF JAVASCRIPT SCRIPTS -->

    <!--JS LIBRARIES -->
    <!-- All Jquery -->
    
    <script src="js/lib/jquery/jquery.min.js"></script>
    <!-- Bootstrap tether Core JavaScript -->
    <script src="js/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="js/lib/sticky-kit-master/dist/sticky-kit.min.js"></script>
    <script src="js/lib/sweetalert/sweetalert.min.js"></script>

    <!--Charts and scripts JavaScript -->
    <script src="js/lib/calendar-2/moment.latest.min.js"></script>
    <script src="js/Chart.js"></script>
    <script src="js/chartjs-plugin-datalabels.js"></script>
    <script src="js/jquery.slimscroll.js"></script> <!-- to have scroll within a div part -->
    <script src="js/scripts.js"></script>
    <script src="js/lib/toastr/toastr.min.js"></script>


    <script>
        $(function () {
            $("#sidebar").load("sidebar.html");
        });
    </script>
    </head>

    <script src="js/incapse-graphs.js"></script>

<script src="js/dashboard_scripts.js"></script>
<!-- Map Resources -->
<script src="https://www.amcharts.com/lib/3/ammap.js" type="text/javascript"></script>
<script src="https://www.amcharts.com/lib/3/maps/js/worldHigh.js" type="text/javascript"></script>
<script src="https://www.amcharts.com/lib/3/themes/dark.js" type="text/javascript"></script>
<script src="https://www.amcharts.com/lib/3/maps/js/worldLow.js"></script>


// Update Circle value for each country
<script>
$(document).ready(function () {
    $.ajax({
        url: 'export_account_stats.json',
        datatype: 'json',
        type: 'get',
        cache: false,

        success: function (data) {
            var randomcolor1 = "";
            $(data.visits_dist_summary[0].data).each(function (index, value) {
                for (var i = 0; i < mapData.length; i++) {
                    if (mapData[i].code.toLowerCase() === value[0]) {
                        mapData[i].value = value[1];
                        break;
                    }
                }
            });


            // get min and max values
            var minBulletSize = 0;
            var maxBulletSize = 70;
            var min = Infinity;
            var max = -Infinity;
            for (var i = 0; i < mapData.length; i++) {
                var value = mapData[i].value;
                if (value < min) {
                    min = value;
                }
                if (value > max) {
                    max = value;
                }
            }

            // it's better to use circle square to show difference between values, not a radius
            var maxSquare = maxBulletSize * maxBulletSize * 2 * Math.PI;
            var minSquare = minBulletSize * minBulletSize * 2 * Math.PI;

            // create circle for each country

            var images = [];
            for (var i = 0; i < mapData.length; i++) {
                var dataItem = mapData[i];
                var value = dataItem.value;
                // calculate size of a bubble
                var square = (value - min) / (max - min) * (maxSquare - minSquare) + minSquare;
                if (square < minSquare) {
                    square = minSquare;
                }
                var size = Math.sqrt(square / (Math.PI * 2));
                var id = dataItem.code;

                if (square > maxSquare / 3) {
                    dataItem.color = "Red"
                } else if (square > maxSquare / 6) {
                    dataItem.color = "OrangeRed"
                } else if (square > maxSquare / 12) {
                    dataItem.color = "Blue"
                } else if (square > maxSquare / 20) {
                    dataItem.color = "YellowGreen"
                } else {
                    dataItem.color = "Grey"
                }

                images.push({
                    "type": "circle",
                    "theme": "none",

                    "width": size,
                    "height": size,
                    "color": dataItem.color,
                    "longitude": latlong[id].longitude,
                    "latitude": latlong[id].latitude,
                    "title": dataItem.name,
                    "value": value
                });
            }

            console.log("map data info")
            console.log(mapData);
            // build map
            var map = AmCharts.makeChart("threatmap", {
                "type": "map",
                "projection": "eckert6",
                "titles": [{
                    "text": "",
                    "size": 14
                }],
                "areasSettings": {
                    //"unlistedAreasColor": "#000000",
                    //"unlistedAreasAlpha": 0.1
                },
                "dataProvider": {
                    "map": "worldLow",
                    "images": images
                },
                "export": {
                    "enabled": true
                }
            });
        }
    });
});


var map = AmCharts.makeChart("mapdiv", {
        type: "map",
        theme: "Map with Bubbles",
        projection: "mercator",
        panEventsEnabled: true,
        backgroundColor: "#535364",
        backgroundAlpha: 1,
        zoomControl: {
            zoomControlEnabled: true
        },
        dataProvider: {
            map: "worldHigh",
            getAreasFromMap: true,
            areas:
                []
        },
        areasSettings: {
            autoZoom: true,
            color: "#B4B4B7",
            colorSolid: "#84ADE9",
            selectedColor: "#84ADE9",
            outlineColor: "#666666",
            rollOverColor: "#9EC2F7",
            rollOverOutlineColor: "#000000"
        }
    });

</script>














    